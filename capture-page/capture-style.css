:root {
    --primary-brand-color: #33A4C9; /* ODZ Blue */
    --secondary-brand-color: #F0C27B; /* ODZ Orange-Yellow */
    --accent-color: #E5A24A; /* Darker Orange */
    --text-dark: #333;
    --text-light: #fff;
    --bg-gradient: linear-gradient(to bottom, var(--accent-color) 0%, var(--secondary-brand-color) 30%, var(--primary-brand-color) 100%);
    --panel-bg-color: #fff;
    --shadow-light: rgba(0, 0, 0, 0.1);
    --shadow-medium: rgba(0, 0, 0, 0.2);
    --border-radius-soft: 12px;
    --font-poppins: 'Poppins', sans-serif;
    --font-fredoka: 'Fredoka', cursive;
    --video-aspect-ratio: 4/3; /* Default aspect ratio for video preview */
}

body {
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
    background: var(--bg-gradient);
    font-family: var(--font-poppins);
    margin: 0;
    padding: 20px;
    box-sizing: border-box;
    color: var(--text-dark);
    overflow-x: hidden; /* Prevent horizontal scroll */
}

/* Global Styles */
h1, h3 {
    font-family: var(--font-fredoka);
    color: var(--text-dark);
    text-align: center;
    margin-bottom: 20px;
}

h1.title {
    font-size: 2.8em;
    color: var(--text-light);
    text-shadow: 2px 2px 4px var(--shadow-medium);
}

.title .booth {
    color: var(--secondary-brand-color);
}

button {
    font-family: var(--font-poppins);
    font-weight: 600;
    border: none;
    border-radius: var(--border-radius-soft);
    cursor: pointer;
    transition: background-color 0.3s ease, transform 0.2s ease;
    box-shadow: var(--shadow-light);
    white-space: nowrap; /* Prevent text wrapping */
}

button:hover {
    transform: translateY(-2px);
}

button:active {
    transform: translateY(0);
}

button:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none;
}

.primary-btn {
    background-color: var(--primary-brand-color);
    color: var(--text-light);
    padding: 12px 25px;
    font-size: 1.1em;
}

.primary-btn:hover {
    background-color: #2a8fb3; /* Slightly darker shade */
}

.secondary-btn {
    background-color: var(--panel-bg-color);
    color: var(--primary-brand-color);
    border: 2px solid var(--primary-brand-color);
    padding: 10px 20px;
    font-size: 1em;
}

.secondary-btn:hover {
    background-color: #e6e6e6;
}

select {
    padding: 10px 15px;
    border-radius: var(--border-radius-soft);
    border: 1px solid #ccc;
    font-family: var(--font-poppins);
    font-size: 1em;
    background-color: #fff;
    box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
    transition: border-color 0.3s ease;
}

select:focus {
    outline: none;
    border-color: var(--primary-brand-color);
}

.spinner-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    color: white;
    font-size: 1.2em;
    z-index: 10; /* Above video */
    border-radius: var(--border-radius-soft);
}

.hidden-spinner {
    display: none;
}

/* Photo Booth Layout */
.photo-booth-wrapper {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
    max-width: 1200px;
    margin-top: 20px;
    gap: 30px; /* Space between main sections */
}

.photobooth-container {
    background-color: var(--panel-bg-color);
    border-radius: var(--border-radius-soft);
    box-shadow: var(--shadow-medium);
    padding: 25px;
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
    max-width: 480px; /* Constrain max width for smaller screens */
    box-sizing: border-box; /* Include padding in width */
}

/* Video Preview Area */
.video-preview-area {
    position: relative;
    width: 100%;
    padding-bottom: calc(100% / var(--video-aspect-ratio)); /* Maintain aspect ratio */
    background-color: #000; /* Black background for letterboxing */
    border-radius: var(--border-radius-soft);
    overflow: hidden; /* Hide parts of video outside aspect ratio */
    margin-bottom: 20px;
    display: flex; /* Use flex to center video inside if needed */
    justify-content: center;
    align-items: center;
}

.video-preview-area video {
    position: absolute; /* Position relative to .video-preview-area */
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover; /* Ensures video fills the area, cropping if necessary */
    transform: scaleX(1); /* Default, not inverted */
    transition: transform 0.3s ease;
}

.video-preview-area video.inverted {
    transform: scaleX(-1);
}

/* Fullscreen Button in Normal Mode */
.normal-mode-capture-btn-container {
    width: 100%; /* Ensure container takes full width */
    display: flex;
    justify-content: center;
    margin-bottom: 20px; /* Space below the button */
}

.normal-mode-capture-btn {
    width: auto;
    min-width: 180px;
    font-size: 1.3em;
    padding: 15px 30px;
}

/* Styles for the flash effect */
#flashOverlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: white;
    opacity: 0;
    transition: opacity 0.1s ease-out; /* Flash duration */
    pointer-events: none; /* Allow clicks to pass through */
    z-index: 5; /* Below countdown, above video */
}

/* Styles for the visual countdown */
#visualCountdown {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-family: var(--font-fredoka);
    font-size: 10em; /* Large size */
    color: rgba(255, 255, 255, 0.9); /* Slightly transparent white */
    text-shadow: 0 0 15px rgba(0, 0, 0, 0.7); /* Soft shadow for readability */
    z-index: 6; /* Higher than flash */
    display: none; /* Hidden by default, shown by JS */
}

/* Styles for the numeric countdown (optional, if used for smaller numbers) */
#countdown {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-family: var(--font-fredoka);
    font-size: 5em;
    color: white;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
    z-index: 7;
    display: none; /* Hidden by default */
}


.controls-section {
    display: flex;
    flex-wrap: wrap; /* Allow items to wrap to next line */
    justify-content: center;
    gap: 15px; /* Space between control items */
    margin-bottom: 20px;
    width: 100%;
}

.controls-section > div {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 5px;
}

.controls-section label {
    font-size: 0.9em;
    color: var(--text-dark);
    font-weight: 600;
}

.bottom-action-buttons {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 15px;
    width: 100%;
    margin-top: 10px;
}


/* Camera Access Message */
#camera-access-message {
    text-align: center;
    color: var(--text-dark);
    padding: 20px;
    background-color: #fff8dc; /* Light yellow background */
    border: 1px solid #ffe799;
    border-radius: var(--border-radius-soft);
    margin-top: 20px;
    display: none; /* Hidden by default, shown by JS if no access */
}

/* Camera Messages within the preview area */
.camera-message-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.8);
    color: white;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    font-size: 1.2em;
    z-index: 8; /* Higher than countdown, but below spinner */
    border-radius: var(--border-radius-soft);
}
.camera-message-overlay i {
    font-size: 2em;
    margin-bottom: 10px;
}


/* Captured Photos Display */
#captured-photos-display {
    background-color: var(--panel-bg-color);
    border-radius: var(--border-radius-soft);
    box-shadow: var(--shadow-medium);
    padding: 25px;
    width: 100%;
    max-width: 480px;
    box-sizing: border-box;
}

#captured-photos-display h3 {
    margin-top: 0;
    color: var(--primary-brand-color);
}

#photoProgressText {
    text-align: center;
    margin-bottom: 15px;
    font-weight: 600;
    color: var(--text-dark);
}

#captured-photos-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); /* Responsive grid */
    gap: 15px;
    justify-content: center;
    padding: 10px; /* Padding inside the grid */
    min-height: 120px; /* Ensure some space even if no photos */
    border: 1px dashed #ddd; /* Visual cue for the grid area */
    border-radius: var(--border-radius-soft);
}

.captured-photo-item {
    position: relative;
    width: 100%;
    padding-bottom: calc(100% / var(--video-aspect-ratio)); /* Maintain aspect ratio */
    background-color: #eee;
    border-radius: var(--border-radius-soft);
    overflow: hidden;
    box-shadow: var(--shadow-light);
    cursor: pointer;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.captured-photo-item:hover {
    transform: translateY(-3px);
    box-shadow: var(--shadow-medium);
}

.captured-photo-item.selected {
    border: 4px solid var(--accent-color); /* Highlight selected photo */
    box-shadow: 0 0 15px rgba(229, 162, 74, 0.7); /* Glow effect */
}

.captured-photo-item img {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover; /* Fill the frame */
    border-radius: var(--border-radius-soft);
}

/* Styles for Fullscreen Mode */
.video-preview-area:fullscreen {
    width: 100vw; /* Take full viewport width */
    height: 100vh; /* Take full viewport height */
    padding-bottom: 0; /* No padding-bottom trick in fullscreen */
    border-radius: 0; /* No border-radius in fullscreen */
    background-color: black; /* Ensure black background for full coverage */
}

.video-preview-area:fullscreen video {
    width: auto; /* Allow width to adjust based on height and aspect ratio */
    height: 100%; /* Take full height of fullscreen container */
    max-width: 100%; /* Ensure it doesn't exceed width */
    object-fit: contain; /* Contain ensures entire video is visible, no cropping */
    /* Maintain aspect ratio within the fullscreen container */
}

/* NEW: Styles for the fullscreen capture button container */
/* Updated z-index to ensure it's on top */
#fullscreen-capture-button-container {
    position: fixed; /* Fixed position relative to viewport */
    bottom: 30px; /* 30px from the bottom */
    left: 50%;
    transform: translateX(-50%); /* Center horizontally */
    z-index: 10000; /* Increased z-index to be sure it's on top */
    width: 90%; /* Adjust as needed */
    max-width: 400px; /* Control max width */
    text-align: center;
    display: none; /* Hidden by default, controlled by JS */
    /* Ensure no background/border from previous debug if any */
    background-color: transparent;
    border: none;
    opacity: 1; /* Ensure not set to 0 by other rules */
    visibility: visible; /* Ensure not set to hidden by other rules */
    top: auto; /* Reset temporary top */
    height: auto; /* Reset temporary height */
}

#fullscreen-capture-button-container .fullscreen-capture-btn {
    width: 100%; /* Make button fill its container */
    margin: 0;
}

/* Style for the capture button when it's at the top in normal mode */
.photobooth-container > .normal-mode-capture-btn {
    margin-bottom: 25px; /* Space below the button */
    /* Ensure it's not absolutely positioned */
    position: relative;
    transform: none;
    /* Inherit default button styles for width/max-width */
}


/* Responsive Adjustments for Capture Page */
@media (min-width: 768px) {
    .photo-booth-wrapper {
        flex-direction: row;
        justify-content: center;
        align-items: flex-start;
    }

    .photobooth-container {
        margin-right: 30px;
        max-width: 500px;
    }

    #captured-photos-display {
        max-width: 400px;
    }

    #captured-photos-grid {
        grid-template-columns: 1fr;
    }
    .captured-photo-item {
        max-width: 250px;
        justify-self: center;
    }
}

@media (max-width: 480px) {
    body {
        padding: 10px;
    }

    h1.title {
        font-size: 2em;
    }

    .photobooth-container, #captured-photos-display {
        padding: 15px;
    }

    .primary-btn, .secondary-btn {
        padding: 10px 15px;
        font-size: 0.9em;
    }

    .controls-section, .bottom-action-buttons {
        flex-direction: column;
        gap: 10px;
    }

    .controls-section button, .controls-section select,
    .bottom-action-buttons button {
        width: 100%;
        max-width: 300px; /* Prevent buttons from becoming too wide on small screens */
    }

    #fullscreen-capture-button-container {
        width: 95%; /* Make it wider on very small screens */
        max-width: 300px; /* Ensure it doesn't get too big */
    }

    .video-preview-area:fullscreen #visualCountdown {
        font-size: 7em; /* Smaller countdown in fullscreen for very small screens */
    }
}
